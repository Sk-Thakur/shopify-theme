{{ 'blog-banner.css' | asset_url | stylesheet_tag }}
{{ 'featured-articles.css' | asset_url | stylesheet_tag }}
<script src="{{ 'blog-banner.js' | asset_url }}" defer="defer"></script>

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 1.2 | round: 0 }}rem;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.4 | round: 0 }}px;
  }
  .section-{{ section.id }} {
    margin-top: {{ section.settings.margin_top | times: 0.4 | round: 0 }}px;
    margin-bottom: {{ section.settings.margin_bottom | times: 0.4 | round: 0 }}rem;
  }
  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}rem;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
    .section-{{ section.id }} {
      margin-top: {{ section.settings.margin_top}}px;
      margin-bottom: {{ section.settings.margin_bottom }}rem;
    }
  }
{%- endstyle -%}

<section
  class="section-{{ section.id }} blog-banner gradient color-{{ section.settings.section_color_scheme }} {% if settings.animations_reveal_on_scroll %} scroll-trigger animate--slide-in{% endif %}"
>
  <div class="blog-pills-wrapper">
    <!-- TAB BUTTONS -->
    <div class="just-tabs">
      <div class="page-width section-{{ section.id }}-padding">
        <div class="just-tabs-buttons">
          {% for block in section.blocks %}
            <button
              class="tablink {% if forloop.first %}active{% endif %} block-btn-{{ block.id }}"
              onclick="openPage('Collection-{{ forloop.index }}', event)"
              data-color="{{ block.settings.featured_bg_color }}"
              {% if forloop.first %}
                id="defaultOpen"
              {% endif %}
            >
              {{ block.settings.ttl_txt }}
            </button>
          {% endfor %}
          <a
            href="/search"
            class="blog-search-btn tablink"
          >
            <span>
              <svg width="19" height="20" viewBox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="8.16797" cy="7.61377" r="6.25586" stroke="#201C1C" stroke-width="2"/>
                <line x1="12.3887" y1="12.5058" x2="18.2487" y2="18.3658" stroke="#201C1C" stroke-width="2"/>
              </svg></span
            >Search
          </a>
        </div>
        <div class="blog-search-bar" style="display: none;">
          <input type="text" id="blogSearchInput" placeholder="Search articles...">
          <button id="blogSearchGo">Go</button>
        </div>
      </div>
    </div>

    <!-- BUTTON, FEATURED POST & TOP BACKGROUND STYLES -->
    <style>
      {% for block in section.blocks %}
        /* Top area background (buttons + featured post) for this tab */
        .section-{{ section.id }} #Collection-{{ forloop.index }} .top-section {
          background-color: {{ block.settings.featured_bg_color }};
        }

        /* Tab button default */
        .section-{{ section.id }} .block-btn-{{ block.id }} {
          color: {{ block.settings.btn_text_color }};
          background-color: {{ block.settings.btn_bg_color }};
          border-color: {{ block.settings.btn_border_color }};
          border-style: solid;
          transition: all 0.3s ease;
        }

        /* Hover */
        .section-{{ section.id }} .block-btn-{{ block.id }}:hover {
          background-color: {{ block.settings.btn_hover_bg_color }};
          border-color: {{ block.settings.btn_hover_bg_color }};
          color: {{ block.settings.btn_text_color_hover }};
        }

        /* Active */


        /* Featured blog styling */
        .section-{{ section.id }} #Collection-{{ forloop.index }} .featured-blog {
          background-color: transparent;
          padding-bottom: 90px;
        }
        @media screen and (max-width: 749px) {
          .section-{{ section.id }} #Collection-{{ forloop.index }} .featured-blog {
          padding-bottom: 50px;
         }
        }
      {% endfor %}
    </style>

    <!-- TAB CONTENT -->
    {% for block in section.blocks %}
      {% assign selected_blog = blogs[block.settings.selected_blog] %}
      <div
        id="Collection-{{ forloop.index }}"
        class="tabcontent"
      >
        <!-- Only this wrapper gets the background color -->
        <div class="top-section">
          <div class="page-width">
            <div class="main-heading">
              <div class="text-center">
                {% if block.settings.main_heading != blank %}
                  <h1>{{ block.settings.main_heading }}</h1>
                {% endif %}
              </div>
            </div>
            {% assign featured_post = selected_blog.articles.first %}
            {% if featured_post %}
              <div class="featured-blog">
                <div class="row align-items-center">
                  <div class="col-md-6">
                    <div class="article-imgg">
                      {{- featured_post.image | image_url: width: 705 | image_tag: class: 'img-fluid' -}}
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="text-center">
                      <h7 class="PRINTF-Regular">{{ selected_blog.title }}</h7>
                      <h3>{{ featured_post.title }}</h3>
                      <p>{{ featured_post.excerpt | strip_html }}</p>
                      <div>
                        <a class="btn-primary" href="{{ featured_post.url }}">Read more</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            {% endif %}
          </div>
        </div>
        <div class="page-width">
          {% if block.settings.grid_heading != blank %}
            <h3 class="grid-heading">{{ block.settings.grid_heading }}</h3>
          {% endif %}

          <!-- Blog grid stays transparent -->
          <div class="blog-grid">
            <div class="featured-articles-slider row">
              {% for article in selected_blog.articles limit: 5 %}
                {% unless forloop.first %}
                  <div class="blog-item col-md-4">
                    <a href="{{ article.url }}" class="featured-articles-slider-card blogModule-posts">
                      <div class="article-imgg">
                        {{- article.image | image_url: width: 470 | image_tag: class: 'img-fluid' -}}
                      </div>
                      <div class="article-info">
                        <h7 class="PRINTF-Regular">{{ selected_blog.title }}</h7>
                        <h4 class="h3">{{ article.title }}</h4>
                      </div>
                    </a>
                  </div>
                {% endunless %}
              {% endfor %}
            </div>
          </div>
          <div class="read-more-btn">
            <a class="blog-load-more btn-primary" href="{{ selected_blog.url }}" class="btn">Load More</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</section>

{% schema %}
{
  "name": "Blog Banner",
  "settings": [
    {
      "type": "color_scheme",
      "id": "section_color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Section Padding and Margin"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 2,
      "unit": "rem",
      "label": "Padding Top",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 2,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 24
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "label": "Margin Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": -50,
      "max": 120,
      "step": 5,
      "unit": "rem",
      "label": "Margin Bottom",
      "default": 0
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "transparent"
    }
  ],
  "blocks": [
    {
      "type": "blog_tab",
      "name": "Blog Category Tab",
      "settings": [
        {
          "type": "blog",
          "id": "selected_blog",
          "label": "Select blog category"
        },
        {
          "type": "text",
          "id": "ttl_txt",
          "label": "Tab Title"
        },
        {
          "type": "color",
          "id": "btn_text_color",
          "label": "Button Text Color"
        },
        {
          "type": "color",
          "id": "btn_bg_color",
          "label": "Button Background Color"
        },
        {
          "type": "color",
          "id": "btn_border_color",
          "label": "Button Border Color"
        },
        {
          "type": "color",
          "id": "btn_hover_bg_color",
          "label": "Button Hover Background Color"
        },
        {
          "type": "color",
          "id": "btn_text_color_hover",
          "label": "Button Text Color Hover"
        },
        {
          "type": "color",
          "id": "featured_bg_color",
          "label": "Featured post background color"
        },
        {
          "type": "text",
          "id": "main_heading",
          "label": "Main heading"
        },
        {
          "type": "text",
          "id": "grid_heading",
          "label": "Blog grid heading"
        },
        {
          "type": "blog",
          "id": "blog",
          "label": "Select blog (to show category)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Blog Banner",
      "blocks": []
    }
  ]
}
{% endschema %}
